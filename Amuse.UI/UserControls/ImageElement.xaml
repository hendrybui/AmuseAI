<UserControl x:Class="Amuse.UI.UserControls.ImageElement"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             Name="ImageElementUI"
             VerticalContentAlignment="Center"
             HorizontalContentAlignment="Center">
    <Grid DataContext="{Binding ElementName=ImageElementUI}">

        <!--Image-->
        <Grid x:Name="SourceContainer" HorizontalAlignment="Center">
            <!--PlaceHolder-->
            <Image Source="{StaticResource PlaceholderImage}" Visibility="{Binding Source, Converter={StaticResource InverseNullVisibilityConverter}}" Stretch="Uniform" Opacity="0.2" Margin="0"/>

            <!--Original-->
            <Grid Visibility="{Binding IsSplitterEnabled, Converter={StaticResource BooleanToVisibilityConverter}}">
                <Image x:Name="ImageOriginalControl" Source="{Binding Original}" Stretch="Uniform" Visibility="{Binding Source, Converter={StaticResource NullVisibilityConverter}}" RenderOptions.BitmapScalingMode="Fant"/>
            </Grid>

            <!--Source-->
            <Image x:Name="ImageSourceControl" Source="{Binding Source}" Stretch="Uniform" RenderOptions.BitmapScalingMode="Fant"/>

            <!--PreviewImage-->
            <Image Source="{Binding Preview}" Stretch="Uniform" Visibility="{Binding Source, Converter={StaticResource InverseNullVisibilityConverter}}"/>
        </Grid>

        <!--Splitter-->
        <Grid Visibility="{Binding IsSplitterEnabled, Converter={StaticResource BooleanToVisibilityConverter}}">
            <Grid x:Name="GridSplitterContainer" MaxWidth="{Binding ActualWidth, ElementName=SourceContainer}" ClipToBounds="True" Visibility="Hidden" PreviewMouseUp="GridSplitter_MouseUp">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition x:Name="GridSplitterColumn" MaxWidth="{Binding ActualWidth, ElementName=SourceContainer}"/>
                    <ColumnDefinition Width="30" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <Grid x:Name="GridSplitterControl" Grid.Column="0" SizeChanged="GridSplitter_SizeChanged"/>
                <GridSplitter Grid.Column="1"  Margin="-15,0,15,0"  Width="30" HorizontalAlignment="Stretch" Background="Transparent" Cursor="ScrollWE" Style="{x:Null}" />
                <Border Grid.Column="1" Margin="-15,0,15,0" BorderBrush="{Binding SplitterColor}" BorderThickness="1,0,1,0" Width="1" IsHitTestVisible="False" HorizontalAlignment="Center"  />
                <Grid Grid.Column="1" Margin="-15,0,15,0"  HorizontalAlignment="Center" VerticalAlignment="Center" ClipToBounds="False" Opacity="1" IsHitTestVisible="False" >
                    <Ellipse  Width="30" Height="30" Stroke="{Binding SplitterColor}" Fill="{Binding SplitterColor}" StrokeThickness="2" />
                    <TextBlock Text="&lt; &gt;" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,0,0,3" Foreground="{Binding Foreground}" FontWeight="Bold" FontSize="16"  />
                </Grid>
            </Grid>
        </Grid>

    </Grid>
</UserControl>
