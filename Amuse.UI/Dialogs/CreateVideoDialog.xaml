<local:BaseDialog x:Class="Amuse.UI.Dialogs.CreateVideoDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Amuse.UI.Dialogs"
        xmlns:controls="clr-namespace:Amuse.UI.UserControls"
        mc:Ignorable="d"
        x:Name="UI"
        Icon="/Images/Icon.png"
        MinWidth="400"
        MaxWidth="500"
        SizeToContent="WidthAndHeight"
        WindowStartupLocation="CenterOwner" 
        SnapsToDevicePixels="True"
        AllowsTransparency="True"
        WindowStyle="None"
        Title="Save History"
        Style="{StaticResource BaseToolWindow}">
    <DockPanel DataContext="{Binding ElementName=UI}" Margin="15, 15, 15, 10">
        <DockPanel DockPanel.Dock="Top">

            <DockPanel DockPanel.Dock="Top" Margin="0,0,0,8">

                <UniformGrid Columns="4">
                    <StackPanel Margin="0,0,2,0">
                        <TextBlock Text="FrameRate" />
                        <TextBox Text="{Binding VideoFrameRate, UpdateSourceTrigger=PropertyChanged}" />
                    </StackPanel>

                    <StackPanel Margin="2,0,0,0">
                        <TextBlock Text="Seconds" />
                        <TextBox Text="{Binding VideoSeconds, UpdateSourceTrigger=PropertyChanged}" />
                    </StackPanel>

                    <TextBlock  Margin="6,19,0,0">
                       <Run Text="Images: " />
                       <Run Text="{Binding VideoFrames.Count, Mode=OneWay, FallbackValue=0}" />
                    </TextBlock>

                    <Button Content="Generate" Command="{Binding GenerateCommand}"  />
                </UniformGrid>

            </DockPanel>

            <!--Video Preview-->
            <Border BorderThickness="1" BorderBrush="{StaticResource ButtonBorderBrush}">
                <Viewbox UseLayoutRounding="True" RenderOptions.BitmapScalingMode="Fant">
                    <Grid Width="{Binding VideoWidth}" Height="{Binding VideoHeight}">
                        <Image Source="{StaticResource PlaceholderImage}" Stretch="Uniform" Visibility="{Binding HasResult, Converter={StaticResource InverseBoolConverter}}" Opacity=".2"/>
                        <MediaElement
                         Volume="0"
                         Source="{Binding VideoFileName}"
                         Stretch="Uniform" 
                         LoadedBehavior="Manual" 
                         UnloadedBehavior="Close" 
                         Loaded="MediaElement_Loaded"
                         MediaEnded="MediaElement_MediaEnded" 
                         MouseLeftButtonDown="MediaElement_MouseDown" >
                            <!--<MediaElement.Effect>
                            <effects:DeeperColorEffect  />
                        </MediaElement.Effect>-->
                        </MediaElement>
                    </Grid>
                </Viewbox>
            </Border>


        </DockPanel>


        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,20,0,0"  Height="30">
            <UniformGrid Columns="2">
                <Button Content="Save" Command="{Binding SaveCommand}" Width="100" IsEnabled="{Binding HasResult}"/>
                <Button Content="Cancel" Command="{Binding CancelCommand}" Width="100"/>
            </UniformGrid>
        </StackPanel>
    </DockPanel>
</local:BaseDialog>